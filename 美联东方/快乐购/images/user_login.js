$(function(){var a={"i":'<i class="icon_err"></i>',"user":"登录名可能是您的手机号、邮箱或用户名","password":"您的密码可能为字母、数字或符号的组合","checkcode":"请输入右侧验证码，不区分大小写","user_error":"用户名不能为空","password_error":"密码不能为空","checkcode_error":"您输入的验证码有误","login_in":"正在登录","login_out":"立即登录"};var b={"show_ec":function(h){showDialog(h,"error","","","1","","","","","","2")},"alert":function(h){alert(h)},"console":function(h){console.log(h)}};var d={"Focusin":function(j,h,i){f=true;if(i=="1"){$("#error_"+j).addClass("err_msg2");$("#error_"+j).removeClass("err_msg err_msg1")}else{$("#"+j).addClass("err_txt");$("#error_"+j).removeClass("err_msg2");$("#error_"+j).addClass("err_msg err_msg1")}$("#error_"+j).show();$("#error_"+j).html(h)},"Focusout":function(i,h){$("#"+i).removeClass("err_txt");$("#error_"+i).hide()}};var g={"code":function(j,i){var h=SHOP_SITE_URL+"/index.php?act=seccode&op=makecode&nchash=";var k=j;document.getElementById(i).src=h+k+"&t="+Math.random()}};var c={"login_href":function(i,h){if(i=="reload"){location.replace(location)}else{if(i=="mall"){location.href=h}else{location.href=h}}},};$("#user_name").focusin(function(){d.Focusin("user_name",a.user,"1")});$("#user_name").focusout(function(){d.Focusout("user_name","1")});$("#password").focusin(function(){d.Focusin("password",a.password,"1")});$("#password").focusout(function(){d.Focusout("password","1")});$("#captcha").focusin(function(){d.Focusin("captcha",a.checkcode,"1")});$("#captcha").focusout(function(){d.Focusout("captcha","1")});var f=true;function e(){if(!f){return}f=!f;var k=$("#user_name").val();if(k==""){d.Focusin("user_name",a.i+a.user_error,"2");return false}else{d.Focusout("user_name","2")}var i=$("#password").val();if(i==""){d.Focusin("password",a.i+a.password_error,"2");return false}else{d.Focusout("password","2")}var h=$("#captcha").val();if(h==""||h.length!=4){d.Focusin("captcha",a.i+a.checkcode_error,"2");return false}else{d.Focusout("captcha","2")}var j=$("#login_form");$.ajax({url:j.attr("action"),type:j.attr("method"),dataType:"json",data:j.serializeArray(),beforeSend:function(){$("#loginsubmit").attr("disabled","disabled").html(a.login_in)},success:function(o){f=true;if(o.state=="1"){var n=o.mall_type;var l=o.ref_type;var m=o.ref_url;if(n=="1"){$.ajax({type:"GET",async:false,crossDomain:true,timeout:1000,url:o.mall_url,data:{time:o.mall_time,code:o.mall_code},dataType:"jsonp",jsonp:"callback",jsonpCallback:"callbackHandler",success:function(q){c.login_href(l,m)},error:function(q){c.login_href(l,m)},complete:function(r,q){if(q=="timeout"){c.login_href(l,m)}}})}else{c.login_href(l,m)}}else{var p=$("#nchash").val();g.code(p,"codeimage");$("#loginsubmit").removeAttr("disabled").html(a.login_out);if(o.state=="-1"){d.Focusin("user_name",a.i+o.msg,"2");return false}else{if(o.state=="-2"){d.Focusin("password",a.i+o.msg,"2");return false}else{if(o.state=="-3"){d.Focusin("captcha",a.i+o.msg,"2");return false}else{if(o.state=="-10"){b.show_ec(o.msg)}else{b.show_ec(o.msg)}}}}}},error:function(){f=true;$("#loginsubmit").removeAttr("disabled").html(a.login_out)}});return false}$("#loginsubmit").click(function(){e()});$("#user_name, #password, #captcha").keypress(function(h){if(h.which==13){e()}})});